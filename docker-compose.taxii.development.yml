version: '3.3'
services:
  unfetter-discover-gateway:
    image: nginx:1.13.5-alpine
    container_name: unfetter-discover-gateway
    links:
     - unfetter-taxii-server
    volumes:
     - ./config/nginx/taxii.conf:/etc/nginx/conf.d.runmode/taxii.conf

  unfetter-taxii-server:
    build: ../taxii-server
    container_name: unfetter-taxii-server
    image: unfetter-taxii-server
    links:
     - cti-stix-store-repository:repository
    ports:
     - "13002:3002"
    volumes:
     - ../taxii-server/src:/usr/share/unfetter-taxii-server/src
     - ./certs/:/etc/pki/tls/certs
    entrypoint:
     - npm
     - start